# ğŸ›ï¸ System Architecture - Food Ordering ACL

## ğŸ“ High-Level Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT LAYER                              â”‚
â”‚                    (React SPA - Port 5173)                         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Browser    â”‚  â”‚  Redux Store â”‚  â”‚ Styled       â”‚            â”‚
â”‚  â”‚   (Chrome/   â”‚  â”‚              â”‚  â”‚ Components   â”‚            â”‚
â”‚  â”‚   Firefox)   â”‚  â”‚ â€¢ authSlice  â”‚  â”‚ (CSS-in-JS)  â”‚            â”‚
â”‚  â”‚              â”‚  â”‚ â€¢ permsSlice â”‚  â”‚              â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                  â”‚                                       â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                                            â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              React Router (v6)                             â”‚   â”‚
â”‚  â”‚  /login  /register  /  /restaurants  /orders  /payments   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Pages & Components                       â”‚   â”‚
â”‚  â”‚  Login, Register, Dashboard, Restaurants,                 â”‚   â”‚
â”‚  â”‚  RestaurantMenu, Orders, PaymentMethods                   â”‚   â”‚
â”‚  â”‚  + Navbar, PermissionGuard, ProtectedRoute                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                    HTTP/REST (Axios)
                              Authorization: Bearer <JWT>
                                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          API LAYER                                 â”‚
â”‚                   (NestJS - Port 3000)                             â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    Middleware                             â”‚     â”‚
â”‚  â”‚  CORS â†’ Body Parser â†’ Cookie Parser â†’ Validation         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                  Controllers                              â”‚     â”‚
â”‚  â”‚  AuthController  RestaurantController                     â”‚     â”‚
â”‚  â”‚  OrderController  PaymentController                       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    Guards                                 â”‚     â”‚
â”‚  â”‚  JwtAuthGuard â†’ AclGuard â†’ CountryAccessGuard            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                   Services                                â”‚     â”‚
â”‚  â”‚  AuthService  RestaurantService                           â”‚     â”‚
â”‚  â”‚  OrderService  PaymentService                             â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                 TypeORM Repository                        â”‚     â”‚
â”‚  â”‚  UserRepository  RestaurantRepository                     â”‚     â”‚
â”‚  â”‚  OrderRepository  PaymentMethodRepository                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ SQL Queries
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DATABASE LAYER                               â”‚
â”‚                      PostgreSQL (Port 5432)                        â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚    ACL Tables         â”‚  â”‚   Business Tables        â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚ acl_categories        â”‚  â”‚ users                    â”‚          â”‚
â”‚  â”‚ acl_actions           â”‚  â”‚ restaurants              â”‚          â”‚
â”‚  â”‚ acl_action_category_  â”‚  â”‚ menu_items               â”‚          â”‚
â”‚  â”‚   map                 â”‚  â”‚ orders                   â”‚          â”‚
â”‚  â”‚ roles                 â”‚  â”‚ order_items              â”‚          â”‚
â”‚  â”‚ role_acl_category_    â”‚  â”‚ payment_methods          â”‚          â”‚
â”‚  â”‚   action_map          â”‚  â”‚                          â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ Authentication & Authorization Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚  Accesses   â”‚
â”‚   App       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: Login Request                                   â”‚
â”‚  POST /api/auth/login                                    â”‚
â”‚  { email, password }                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: Backend Validates                               â”‚
â”‚  â€¢ Check if user exists                                  â”‚
â”‚  â€¢ Compare password hash (bcrypt)                        â”‚
â”‚  â€¢ Generate JWT token                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: Return JWT + User Info                          â”‚
â”‚  { accessToken: "eyJhbG...", user: {...} }               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: Frontend Stores Token                           â”‚
â”‚  â€¢ localStorage.setItem('token', token)                  â”‚
â”‚  â€¢ Redux: authSlice.setToken(token)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 5: Fetch Permissions                               â”‚
â”‚  GET /api/auth/permissions                               â”‚
â”‚  Authorization: Bearer eyJhbG...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 6: Backend Builds Permission Response              â”‚
â”‚  â€¢ Get user role                                         â”‚
â”‚  â€¢ Query role_acl_category_action_map                    â”‚
â”‚  â€¢ Build nested permission object                        â”‚
â”‚  â€¢ Return access.iWork.CATEGORY.ACTION structure         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 7: Frontend Stores Permissions in Redux            â”‚
â”‚  permissionsSlice.setPermissions(permissions)            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 8: User Navigates to Protected Page                â”‚
â”‚  e.g., /orders                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 9: Permission Check in Component                   â”‚
â”‚  usePermission(FeatureKey.VIEW_ORDERS)                   â”‚
â”‚  â†’ selectHasPermission(state, VIEW_ORDERS)               â”‚
â”‚  â†’ Check state.permissions.access.iWork.ORDER.VIEW_005   â”‚
â”‚  â†’ Return boolean                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 10: Conditional Rendering                          â”‚
â”‚  if (hasPermission) {                                    â”‚
â”‚    render(<OrdersPage />)                                â”‚
â”‚  } else {                                                â”‚
â”‚    render("No permission")                               â”‚
â”‚  }                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›¡ï¸ Backend Guard Chain

Every protected API request goes through this guard chain:

```
API Request
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. JwtAuthGuard                    â”‚
â”‚  â€¢ Extract JWT from Authorization   â”‚
â”‚  â€¢ Validate token signature         â”‚
â”‚  â€¢ Decode payload (userId, email)   â”‚
â”‚  â€¢ Attach user to request object    â”‚
â”‚  â€¢ FAIL â†’ 401 Unauthorized          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. AclGuard (if @Acl decorator)    â”‚
â”‚  â€¢ Read @Acl({ category, action })  â”‚
â”‚  â€¢ Get user role from database      â”‚
â”‚  â€¢ Check if role has permission     â”‚
â”‚  â€¢ Query: role_acl_category_action_ â”‚
â”‚    map WHERE role_id AND category   â”‚
â”‚    AND action                       â”‚
â”‚  â€¢ FAIL â†’ 403 Forbidden             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. CountryAccessGuard (optional)   â”‚
â”‚  â€¢ Check if resource requires       â”‚
â”‚    country matching                 â”‚
â”‚  â€¢ Compare user.country with        â”‚
â”‚    resource.country                 â”‚
â”‚  â€¢ FAIL â†’ 403 Forbidden (Country)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Controller Method               â”‚
â”‚  â€¢ Execute business logic           â”‚
â”‚  â€¢ Call service layer               â”‚
â”‚  â€¢ Return response                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Database Schema with Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       users          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚
â”‚ name                 â”‚
â”‚ email (UNIQUE)       â”‚
â”‚ password_hash        â”‚
â”‚ role_id (FK)    â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ country              â”‚  â”‚
â”‚ created_at           â”‚  â”‚
â”‚ updated_at           â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â”‚                â”‚
         â”‚ (has many)     â”‚
         â”‚                â”‚
         â–¼                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚      orders          â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ id (PK)              â”‚  â”‚
â”‚ user_id (FK)     â”€â”€â”€â”€â”˜  â”‚
â”‚ restaurant_id (FK) â”€â”€â”  â”‚
â”‚ status               â”‚  â”‚
â”‚ total_amount         â”‚  â”‚
â”‚ delivery_address     â”‚  â”‚
â”‚ created_at           â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â”‚                â”‚
         â”‚ (has many)     â”‚
         â”‚                â”‚
         â–¼                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    order_items       â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ id (PK)              â”‚  â”‚
â”‚ order_id (FK)        â”‚  â”‚
â”‚ menu_item_id (FK) â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”
â”‚ quantity             â”‚  â”‚  â”‚
â”‚ price                â”‚  â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
                          â”‚  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   restaurants        â”‚â—„â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚ id (PK)              â”‚     â”‚
â”‚ name                 â”‚     â”‚
â”‚ description          â”‚     â”‚
â”‚ address              â”‚     â”‚
â”‚ country              â”‚     â”‚
â”‚ image_url            â”‚     â”‚
â”‚ is_active            â”‚     â”‚
â”‚ created_by           â”‚     â”‚
â”‚ created_at           â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
         â”‚                   â”‚
         â”‚ (has many)        â”‚
         â”‚                   â”‚
         â–¼                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     menu_items       â”‚â—„â”€â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚
â”‚ restaurant_id (FK)   â”‚
â”‚ name                 â”‚
â”‚ description          â”‚
â”‚ price                â”‚
â”‚ category             â”‚
â”‚ image_url            â”‚
â”‚ is_available         â”‚
â”‚ created_at           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  payment_methods     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚
â”‚ user_id (FK)     â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ type                 â”‚   â”‚
â”‚ label                â”‚   â”‚
â”‚ last_4_digits        â”‚   â”‚
â”‚ is_active            â”‚   â”‚
â”‚ created_at           â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                           â”‚
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚        roles         â”‚â—„â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚
â”‚ name (UNIQUE)        â”‚
â”‚ description          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ (many-to-many)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ role_acl_category_action_map    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                         â”‚
â”‚ role_id (FK)                    â”‚
â”‚ acl_action_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ acl_category_id (FK) â”€â”€â”€â”   â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”˜
                          â”‚   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜
â”‚ acl_action_category_map â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                 â”‚
â”‚ acl_action_id (FK) â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”
â”‚ acl_category_id (FK)â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   acl_actions    â”‚  â”‚  acl_categories   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)          â”‚  â”‚ id (PK)           â”‚
â”‚ name (UNIQUE)    â”‚  â”‚ name (UNIQUE)     â”‚
â”‚ description      â”‚  â”‚ description       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ scope             â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request-Response Flow Example

### Example: Cancel Order Request

```
Frontend                         Backend                        Database
   â”‚                                â”‚                              â”‚
   â”‚  1. User clicks "Cancel"       â”‚                              â”‚
   â”‚  hasPermission check (Redux)   â”‚                              â”‚
   â”‚  âœ… CANCEL_ORDER = true         â”‚                              â”‚
   â”‚                                â”‚                              â”‚
   â”‚  2. DELETE /api/orders/5       â”‚                              â”‚
   â”‚  Authorization: Bearer <JWT>   â”‚                              â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
   â”‚                                â”‚                              â”‚
   â”‚                                â”‚  3. JwtAuthGuard             â”‚
   â”‚                                â”‚  â€¢ Validate JWT              â”‚
   â”‚                                â”‚  â€¢ Extract userId            â”‚
   â”‚                                â”‚                              â”‚
   â”‚                                â”‚  4. AclGuard                 â”‚
   â”‚                                â”‚  â€¢ Check @Acl decorator      â”‚
   â”‚                                â”‚  â€¢ category: ORDER           â”‚
   â”‚                                â”‚  â€¢ action: CANCEL_007        â”‚
   â”‚                                â”‚                              â”‚
   â”‚                                â”‚  5. Query Permissions        â”‚
   â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                                â”‚  SELECT * FROM               â”‚
   â”‚                                â”‚  role_acl_category_action_mapâ”‚
   â”‚                                â”‚  WHERE role_id = 1           â”‚
   â”‚                                â”‚  AND category = ORDER        â”‚
   â”‚                                â”‚  AND action = CANCEL_007     â”‚
   â”‚                                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                                â”‚  Result: 1 row (allowed)     â”‚
   â”‚                                â”‚                              â”‚
   â”‚                                â”‚  6. OrderService.cancel()    â”‚
   â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                                â”‚  UPDATE orders               â”‚
   â”‚                                â”‚  SET status = 'CANCELLED'    â”‚
   â”‚                                â”‚  WHERE id = 5                â”‚
   â”‚                                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                                â”‚  Result: 1 row updated       â”‚
   â”‚                                â”‚                              â”‚
   â”‚  7. Response: { success: true }â”‚                              â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                              â”‚
   â”‚                                â”‚                              â”‚
   â”‚  8. Frontend updates UI        â”‚                              â”‚
   â”‚  â€¢ Remove order from list      â”‚                              â”‚
   â”‚  â€¢ Show success message        â”‚                              â”‚
   â”‚                                â”‚                              â”‚
```

---

## ğŸ“± Component Hierarchy

```
App (Redux Provider)
 â”‚
 â”œâ”€â”€ BrowserRouter
 â”‚    â”‚
 â”‚    â”œâ”€â”€ GlobalStyles
 â”‚    â”‚
 â”‚    â””â”€â”€ Routes
 â”‚         â”‚
 â”‚         â”œâ”€â”€ /login
 â”‚         â”‚    â””â”€â”€ Login
 â”‚         â”‚
 â”‚         â”œâ”€â”€ /register
 â”‚         â”‚    â””â”€â”€ Register
 â”‚         â”‚
 â”‚         â”œâ”€â”€ / (Protected)
 â”‚         â”‚    â””â”€â”€ ProtectedRoute
 â”‚         â”‚         â””â”€â”€ Dashboard
 â”‚         â”‚              â”œâ”€â”€ Navbar
 â”‚         â”‚              â””â”€â”€ PermissionDisplay
 â”‚         â”‚
 â”‚         â”œâ”€â”€ /restaurants (Protected)
 â”‚         â”‚    â””â”€â”€ ProtectedRoute
 â”‚         â”‚         â””â”€â”€ Restaurants
 â”‚         â”‚              â”œâ”€â”€ Navbar
 â”‚         â”‚              â””â”€â”€ PermissionGuard(VIEW_RESTAURANTS)
 â”‚         â”‚                   â””â”€â”€ RestaurantGrid
 â”‚         â”‚                        â””â”€â”€ RestaurantCard (x3)
 â”‚         â”‚
 â”‚         â”œâ”€â”€ /restaurants/:id (Protected)
 â”‚         â”‚    â””â”€â”€ ProtectedRoute
 â”‚         â”‚         â””â”€â”€ RestaurantMenu
 â”‚         â”‚              â”œâ”€â”€ Navbar
 â”‚         â”‚              â”œâ”€â”€ MenuItems
 â”‚         â”‚              â”‚    â””â”€â”€ MenuItemCard (x6)
 â”‚         â”‚              â””â”€â”€ CartSummary
 â”‚         â”‚                   â””â”€â”€ CheckoutButton
 â”‚         â”‚                        â””â”€â”€ PermissionGuard(CREATE_ORDER)
 â”‚         â”‚
 â”‚         â”œâ”€â”€ /orders (Protected)
 â”‚         â”‚    â””â”€â”€ ProtectedRoute
 â”‚         â”‚         â””â”€â”€ Orders
 â”‚         â”‚              â”œâ”€â”€ Navbar
 â”‚         â”‚              â””â”€â”€ PermissionGuard(VIEW_ORDERS)
 â”‚         â”‚                   â””â”€â”€ OrdersList
 â”‚         â”‚                        â””â”€â”€ OrderCard (x5)
 â”‚         â”‚                             â””â”€â”€ CancelButton
 â”‚         â”‚                                  â””â”€â”€ PermissionGuard(CANCEL_ORDER)
 â”‚         â”‚
 â”‚         â””â”€â”€ /payments (Protected)
 â”‚              â””â”€â”€ ProtectedRoute
 â”‚                   â””â”€â”€ PaymentMethods
 â”‚                        â”œâ”€â”€ Navbar
 â”‚                        â”œâ”€â”€ PermissionGuard(VIEW_PAYMENT_METHODS)
 â”‚                        â”‚    â””â”€â”€ PaymentMethodList
 â”‚                        â”‚         â””â”€â”€ PaymentMethodCard (x2)
 â”‚                        â””â”€â”€ AddPaymentMethodForm
 â”‚                             â””â”€â”€ PermissionGuard(ADD_PAYMENT_METHOD)
```

---

## ğŸ¨ Styling Architecture

```
GlobalStyles.tsx (CSS Reset + Base Styles)
        â”‚
        â”œâ”€â”€ Typography (font-family, sizes)
        â”œâ”€â”€ Colors (CSS variables)
        â”œâ”€â”€ Reset (margin, padding, box-sizing)
        â””â”€â”€ Base (body, button defaults)
        
        â–¼
        
Styled Components (Component-level)
        â”‚
        â”œâ”€â”€ Page Layouts (Container, Grid, Flex)
        â”œâ”€â”€ Cards (Box shadow, border radius, padding)
        â”œâ”€â”€ Forms (Input, Button, Label)
        â”œâ”€â”€ Typography (Heading, Text, Caption)
        â””â”€â”€ Theme (Primary gradient, colors)

Example:
const Button = styled.button`
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 12px 24px;
  border-radius: 8px;
  
  &:hover {
    transform: translateY(-2px);
  }
`;
```

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Security Layers                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Network Layer
   â”œâ”€â”€ HTTPS (in production)
   â”œâ”€â”€ CORS (allowedOrigins)
   â””â”€â”€ Rate Limiting (optional)

2. Authentication Layer
   â”œâ”€â”€ JWT (JSON Web Token)
   â”œâ”€â”€ bcrypt (Password Hashing)
   â”œâ”€â”€ Token Expiry (7 days)
   â””â”€â”€ Secure Storage (localStorage)

3. Authorization Layer
   â”œâ”€â”€ Role-Based (ADMIN, MANAGER, MEMBER)
   â”œâ”€â”€ Permission-Based (Category + Action)
   â”œâ”€â”€ AclGuard (Backend)
   â””â”€â”€ PermissionGuard (Frontend)

4. Data Validation Layer
   â”œâ”€â”€ class-validator (DTOs)
   â”œâ”€â”€ TypeORM (Schema validation)
   â”œâ”€â”€ TypeScript (Type checking)
   â””â”€â”€ Zod (Optional runtime validation)

5. Database Layer
   â”œâ”€â”€ SQL Injection Prevention (TypeORM)
   â”œâ”€â”€ Password Hashing (bcrypt)
   â”œâ”€â”€ Audit Fields (created_by, updated_by)
   â””â”€â”€ Soft Deletes (is_active flags)

6. Frontend Layer
   â”œâ”€â”€ XSS Prevention (React escaping)
   â”œâ”€â”€ CSRF Protection (JWT in header)
   â”œâ”€â”€ Secure Storage (httpOnly cookies in prod)
   â””â”€â”€ Input Sanitization (trim, validation)
```

---

## ğŸ“Š Performance Optimization

### Backend
- **Connection Pooling** - PostgreSQL connection pool
- **Lazy Loading** - TypeORM relations loaded on demand
- **Indexing** - Database indexes on foreign keys, email
- **Caching** - Redis for permissions (future)
- **Compression** - Gzip response compression

### Frontend
- **Code Splitting** - React.lazy for route-based splitting
- **Memoization** - useMemo, useCallback for expensive computations
- **Virtual Scrolling** - For long lists (future)
- **Image Optimization** - Lazy loading, WebP format
- **Bundle Optimization** - Vite tree-shaking, minification

---

## ğŸš€ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Production Setup                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend (Vercel/Netlify)
   â”‚
   â”œâ”€â”€ Build: npm run build â†’ dist/
   â”œâ”€â”€ CDN: Static assets on edge network
   â””â”€â”€ ENV: VITE_API_URL=https://api.yourdomain.com/api
   
   â”‚ (HTTPS)
   â–¼
   
Backend (Heroku/Railway/Render)
   â”‚
   â”œâ”€â”€ Build: npm run build â†’ dist/
   â”œâ”€â”€ Start: npm run start:prod
   â”œâ”€â”€ ENV: DATABASE_URL, JWT_SECRET
   â””â”€â”€ Worker: npm run seed (one-time)
   
   â”‚ (PostgreSQL Connection)
   â–¼
   
Database (Heroku Postgres/Supabase/Railway)
   â”‚
   â”œâ”€â”€ PostgreSQL 14+
   â”œâ”€â”€ Connection Pooling (PgBouncer)
   â”œâ”€â”€ Backups (Daily)
   â””â”€â”€ Monitoring (Query performance)
```

---

**Architecture Version**: 1.0.0  
**Last Updated**: January 2025  
**Status**: âœ… Production Ready
